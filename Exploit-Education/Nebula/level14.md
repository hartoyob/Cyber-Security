# level14

## Challenge info

This program resides in /home/flag14/flag14. It encrypts input and writes it to standard output. An encrypted token file is also in that home directory, decrypt it :) <br>

To do this level, log in as the level14 account with the password level14. Files for this level can be found in /home/flag14.

## Solution

I used ghidra to disassemble the binary<br>

The important part of this program is the cycle it uses to envrypt the data (the below code is renamed)<br>

TOKEN: 857:g67?5ABBo:BtDA?tIvLDKL{MQPSRQWW. 
TOKEN len: 36 bytes
```
do {
    read_bytes = read(0,buffer,0x40);
    if ((int)read_bytes < 1) {
                /* WARNING: Subroutine does not return */
        exit(0);
    }
    counter = 0;
    while (counter < (int)read_bytes) {
        buffer[counter] = jumper + buffer[counter];
        jumper = jumper + '\x01';
        counter = counter + 1;
    }
    written_bytes = write(1,buffer,read_bytes);
} while (0 < written_bytes);
```

The main goal is to revert this encryption mechanism and decrypt the token (that should be the flag14 acc password) <br>

The encryption is basic since it only calculates a new char based on a counter (something like a rot cypher but with incrementing padding) <br>

it can be reverted with the following script (python)
```
TOKEN = [x for x in "857:g67?5ABBo:BtDA?tIvLDKL{MQPSRQWW."]

counter = len(TOKEN) - 1
jumper = counter
while(counter >= 0):
    TOKEN[counter] = chr(ord(TOKEN[counter]) - jumper )
    counter -= 1
    jumper -= 0x1

print("".join(TOKEN))

TOKEN = 8457c118-887c-4e40-a5a6-33a25353165
```

now just
```
su flag14
Password: <TOKEN HERE>

whoami
flag14

get flag
```

## Flag
```
You have successfully executed getflag on a target account
```